<?xml version = '1.0' encoding = 'UTF-8'?>
<TableSettings class="oracle.dbtools.raptor.controls.grid.RaptorGridPersistedSettings" xmlns="http://xmlns.oracle.com/jdeveloper/110000/Table-attributes">
   <columnPositions class="java.util.ArrayList">
      <Item class="java.lang.String">JOB_NAME</Item>
      <Item class="java.lang.String">JOB_ACTION</Item>
      <Item class="java.lang.String">STATE</Item>
      <Item class="java.lang.String">NEXT_RUN_DATE</Item>
      <Item class="java.lang.String">INTERVAL</Item>
      <Item class="java.lang.String">STATUS</Item>
   </columnPositions>
   <columnWidths>
      <Item>72</Item>
      <Item>209</Item>
      <Item>59</Item>
      <Item>293</Item>
      <Item>67</Item>
      <Item>57</Item>
   </columnWidths>
   <searchParams class="java.util.ArrayList"/>
   <sortClauses>
      <Item/>
   </sortClauses>
   <uniqueName>IdeConnections%23esdwith v as (
  select job_name,
         job_action,
         --enabled,
         --case when (state = 'SCHEDULED' and last_run_duration is not null ) then 'CLEAR' else 'ALERT' end as status,
         state, 
         last_run_duration
         failure_count,
         last_start_date,
         last_run_duration,
         next_run_date
         --FREQ=MINUTELY;INTERVAL=10;
         --regexp_substr(repeat_interval, '^FREQ=.*;INTERVAL=\d+', 1, 1) minutely
                ,regexp_substr(regexp_substr(repeat_interval, '[^;]+;', 1, 1), '[^=]+', 1, 2) freq  -- MINUTELY;
                ,replace(regexp_substr(regexp_substr(repeat_interval, '[^;]+;', 1, 2), '[^=]+', 1, 2),';','') interval  -- 10;
  from user_scheduler_jobs 
  WHERE enabled = 'TRUE' 
  and job_name in ('TEST_JOB')
)
select job_name, 
       job_action,
       state,
       next_run_date,
       interval,
       case when (state = 'SCHEDULED' and last_run_duration is not null and next_run_date > systimestamp - NUMTODSINTERVAL(10, 'MINUTE')) then 'CLEAR' else 'ALERT' end as status
from v</uniqueName>
</TableSettings>
